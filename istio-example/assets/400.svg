<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="424px" preserveAspectRatio="none" style="width:1318px;height:424px;background:#FFFFFF;" version="1.1" viewBox="0 0 1318 424" width="1318px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="412.082" style="stroke:#181818;stroke-width:0.5;" width="462" x="481.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="139" x="643" y="18.5684">Прикладной сервис</text><rect fill="#FFFFFF" height="177.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="562.5" y="143.4199"/><rect fill="#FFFFFF" height="103.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="902.5" y="188.041"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="1242.5" y="232.6621"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="55" x2="55" y1="81.4883" y2="338.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="567.5" x2="567.5" y1="81.4883" y2="338.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="907.5" x2="907.5" y1="81.4883" y2="338.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1247" x2="1247" y1="81.4883" y2="338.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="5" y="78.5352">Пользователь</text><ellipse cx="55.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M55.5,21.5 L55.5,48.5 M42.5,29.5 L68.5,29.5 M55.5,48.5 L42.5,63.5 M55.5,48.5 L68.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="5" y="351.1289">Пользователь</text><ellipse cx="55.5" cy="362.582" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M55.5,370.582 L55.5,397.582 M42.5,378.582 L68.5,378.582 M55.5,397.582 L42.5,412.582 M55.5,397.582 L68.5,412.582 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164" x="485.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="492.5" y="70.5352">Основной контейнер</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164" x="485.5" y="337.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="492.5" y="358.1289">Основной контейнер</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="875.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="882.5" y="70.5352">Sidecar</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="875.5" y="337.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="882.5" y="358.1289">Sidecar</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129" x="1183" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="1190" y="70.5352">Внешний сервис</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129" x="1183" y="337.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="1190" y="358.1289">Внешний сервис</text><rect fill="#FFFFFF" height="177.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="562.5" y="143.4199"/><rect fill="#FFFFFF" height="103.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="902.5" y="188.041"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="1242.5" y="232.6621"/><polygon fill="#181818" points="550.5,139.4199,560.5,143.4199,550.5,147.4199,554.5,143.4199" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="55.5" x2="556.5" y1="143.4199" y2="143.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="62.5" y="123.3672">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="75.5" y="108.0566">kubectl exec \</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="462" x="75.5" y="123.3672">"$(kubectl get pod -l app=sleep -o jsonpath={.items..metadata.name})" \</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="475" x="75.5" y="138.6777">-c sleep -- curl -svS http://my-nginx.mesh-external.svc.cluster.local:443</text><polygon fill="#181818" points="890.5,184.041,900.5,188.041,890.5,192.041,894.5,188.041" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="572.5" x2="896.5" y1="188.041" y2="188.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="579.5" y="175.6436">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="592.5" y="167.9883">HTTP GET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294" x="596.5" y="183.2988">my-nginx.mesh-external.svc.cluster.local:443</text><polygon fill="#181818" points="1230.5,228.6621,1240.5,232.6621,1230.5,236.6621,1234.5,232.6621" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="912.5" x2="1236.5" y1="232.6621" y2="232.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="919.5" y="220.2646">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="932.5" y="212.6094">HTTP GET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294" x="936.5" y="227.9199">my-nginx.mesh-external.svc.cluster.local:443</text><polygon fill="#181818" points="923.5,257.9727,913.5,261.9727,923.5,265.9727,919.5,261.9727" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="917.5" x2="1246.5" y1="261.9727" y2="261.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="929.5" y="257.2305">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="942.5" y="257.2305">status 400</text><polygon fill="#181818" points="583.5,287.2832,573.5,291.2832,583.5,295.2832,579.5,291.2832" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="577.5" x2="906.5" y1="291.2832" y2="291.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="589.5" y="286.541">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="602.5" y="286.541">status 400</text><polygon fill="#181818" points="66.5,316.5938,56.5,320.5938,66.5,324.5938,62.5,320.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="60.5" x2="566.5" y1="320.5938" y2="320.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="72.5" y="315.8516">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="85.5" y="315.8516"> </text><!--MD5=[5bff89e530f2610bc1c6f618b12bbb2c]
@startuml

actor Пользователь as User

box Прикладной сервис
    participant Sleep as "Основной контейнер"
    participant Sidecar
end box 


participant External as "Внешний сервис"

autonumber

User->Sleep++: kubectl exec \ \n"$(kubectl get pod -l app=sleep -o jsonpath={.items..metadata.name})" \ \n-c sleep - - curl -svS http://my-nginx.mesh-external.svc.cluster.local:443
    Sleep->Sidecar++: HTTP GET \n my-nginx.mesh-external.svc.cluster.local:443
        Sidecar->External++: HTTP GET \n my-nginx.mesh-external.svc.cluster.local:443
        return status 400
    return status 400
return
@end

PlantUML version 1.2022.7(Mon Aug 22 20:01:30 MSK 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: ru
Country: RU
--></g></svg>